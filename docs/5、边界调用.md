# 系统边界接口文档

本文档描述了系统的外部调用接口，包括CLI命令、API端点、配置参数等边界机制。

## 命令行接口 (CLI)

### litho-book

**描述**: A web-based reader for litho-generated documentation

**源文件**: `src/cli.rs`

**参数**:

- `docs_dir` (PathBuf): 必需 - Path to the markdown documentation directory

**选项**:

- `port, p`(u16): 可选 - Port to serve the web interface on (默认: `3000`)
- `host`(String): 可选 - Host to bind the server to (默认: `127.0.0.1`)
- `open, o`(bool): 可选 - Open browser automatically after starting the server
- `verbose, v`(bool): 可选 - Enable verbose logging

**使用示例**:

```bash
litho-book ./docs
```

```bash
litho-book ./docs -p 8080 --host 0.0.0.0 --open
```

```bash
litho-book ./notes --port 3000 --verbose
```

## API接口

### GET /

**描述**: Serve the main index page with document tree and UI

**源文件**: `src/server.rs`

**响应格式**: HTML

### GET /api/file

**描述**: Get file content and render as HTML

**源文件**: `src/server.rs`

**请求格式**: Query parameter 'file' specifying the file path

**响应格式**: JSON with FileResponse structure

### GET /api/tree

**描述**: Get the document tree structure

**源文件**: `src/server.rs`

**响应格式**: JSON with document tree hierarchy

### GET /api/search

**描述**: Search for content with full-text search

**源文件**: `src/server.rs`

**请求格式**: Query parameter 'q' containing search term

**响应格式**: JSON with SearchResponse structure

### GET /api/stats

**描述**: Get statistics about the document tree

**源文件**: `src/server.rs`

**响应格式**: JSON with StatsResponse structure

### POST /api/chat

**描述**: AI assistant streaming chat endpoint

**源文件**: `src/server.rs`

**请求格式**: JSON with ChatRequest structure containing message, context, and history

**响应格式**: SSE (Server-Sent Events) stream of StreamEvent objects

**认证方式**: Bearer token embedded in code for ZhipuAI API

### GET /health

**描述**: Health check endpoint

**源文件**: `src/server.rs`

**响应格式**: JSON with health status and version info

## 集成建议

### CLI

Use the command line interface to start the documentation server with custom configuration

**示例代码**:

```
litho-book ./my-docs --port 8080 --host 0.0.0.0 --open --verbose
```

**最佳实践**:

- Always validate that your documentation directory exists before starting
- Use ports >= 1024 to avoid requiring administrator privileges
- Enable verbose logging (--verbose) when debugging startup issues
- Use --open flag to automatically launch browser after startup

### API

Integrate with the RESTful API to build custom frontends or automation scripts

**示例代码**:

```
curl "http://localhost:3000/api/search?q=architecture"
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Explain the system architecture", "context": "..."}'
```

**最佳实践**:

- Cache responses from /api/tree and /api/stats endpoints for performance
- Implement proper error handling for 404 (file not found) and 500 (server error) responses
- Respect rate limits when making multiple requests
- Use the health endpoint to check server status before making requests

### Security

Secure the application when exposing beyond localhost

**示例代码**:

```
litho-book ./docs --host 0.0.0.0 --port 8080
# Add reverse proxy with authentication
```

**最佳实践**:

- Avoid binding to 0.0.0.0 in production without additional security measures
- Consider adding JWT or API key authentication for the API endpoints
- Rotate the hardcoded ZhipuAI API key regularly
- Monitor logs for unauthorized access attempts


---

**分析置信度**: 9.5/10
